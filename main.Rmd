---
title: "Main"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
#Dependencies
```{r}
library(tidyverse)
library(plotly)
library(dplyr)
library(klaR)

```

```{r}
data.tb <- read_csv("./data/BlackFriday.csv")
data.tb %>% head(25)

test.tb <- data.tb %>% head(2000)

```
#find unique values for Age
```{r}
unique(test.tb$Age)  
```

#functions to filter Ages into return values (numeric representations of the group)
```{r}
ageFilter <- function(age) {
  switch(age, "0-17"=1, "18-25"=2, "26-35"=3, "36-45"=4, "46-50"=5, "51-55"=6, "55+"=7)
}
ageFilter("51-55")
```
#pip Age vector into ageFilter(), append to tibble
```{r}
##data.tb$age <- ageFilter(data.tb$Age)
test.tb$age <- test.tb$Age

#data.tb %>% head()
for (i in 1:length(test.tb$age)) {
  test.tb$age[i] <- ageFilter(test.tb$age[i])
  ##print(test.tb$Age + " " + test.tb$age)
}

```

#Regression: Age vs Purchase Value
```{r}
fit <- lm(formula= test.tb$Purchase ~ test.tb$age + 0, data=test.tb)
fit[1]
```
#Correlation: Age vs Purchase Value
```{r}
cor(test.tb$age %>% as.numeric(), test.tb$Purchase %>% as.numeric())
```

```{r}
test_na.tb <- na.omit(test.tb)

plot <- plot_ly(
  x = c(test_na.tb$Age),
  y = c(test_na.tb$Purchase),
  name = "Age vs. Purchase Amount",
  type = "bar"
)

plot
```


